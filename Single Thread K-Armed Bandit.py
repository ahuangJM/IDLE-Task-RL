import sys
import random
import numpy as np
import matplotlib.pyplot as plt

def bandit(action, mu, sigma, k): #TODO change this
    env_reward = None
    left = None
    right = None
    if (k%2==0):
        left = np.random.normal(mu, sigma, k/2)
        right = np.random.normal(mu, sigma, k/2)
    else:
        left = np.random.normal(mu, sigma, (k-1)/2)
        right = np.random.normal(mu, sigma, (k+1)/2)
    left = np.sort(left)
    right = np.sort(right)[::-1]
    env_reward = np.concatenate([left, right])
    return env_reward[action]

if __name__ == "__main__":
    # Q = [] # Estimate value
    # N = [] # Actions
    # reward_hist = []
    # k = 0
    # prob = 0
    # mu = 0 # defaults mean
    # sigma = 0.1 # default standard deviation

    # k = int(sys.argv[1]) # number of arms
    # prob = float(sys.argv[2]) # [0,1] chance of random action
    # mu = float(sys.argv[3]) # mean
    # sigma = float(sys.argv[4]) # standard deviation

    # reward_hist = [0]*250
    
    # # f = open('D:\\Users\\AlanJ\\Documents\\GitHub\\IDLE-Task-RL\\karmBandit.txt', 'w+')

    # for n in range(0, 1000):
    #     Q = [0] * k
    #     N = [0] * k
    #     for _ in range(0, 250):
    #         choosen_action = 0
    #         if (random.uniform(0, 1) <= (1-prob)):
    #             max_estimate = max(Q)
    #             max_actions = []
    #             i = 0
    #             for q in Q:
    #                 if q == max_estimate:
    #                     max_actions.append(i)
    #                 i+=1
    #             choosen_action = random.choice(max_actions)
    #         else:
    #             choosen_action = random.randint(0, k-1)
    #         reward = bandit(choosen_action, mu, sigma, k)
    #         N[choosen_action] = N[choosen_action]+ 1
    #         Q[choosen_action] = Q[choosen_action] + (reward-Q[choosen_action])/N[choosen_action]
    #         reward_hist[_] = reward_hist[_] + reward
    #         # f.write("A={}\tR={}\n".format(choosen_action, reward))

    # # f.close()

    # reward_hist = [x / 1000 for x in reward_hist]
    reward_hist = [0.651791,0.772705,0.764562,0.664560,0.659244,0.739664,0.729900,0.672747,0.687450,0.656356,0.674809,0.706312,0.660645,0.712146,0.604213,0.739777,0.650726,0.682972,0.675963,0.763341,0.606955,0.688003,0.650208,0.638770,0.698213,0.783447,0.772010,0.699367,0.730971,0.693383,0.639573,0.696561,0.646410,0.702783,0.718875,0.747210,0.718709,0.704414,0.642510,0.748999,0.765755,0.631479,0.661191,0.662945,0.750610,0.690564,0.638345,0.737955,0.696293,0.670127,0.649877,0.623162,0.638612,0.589641,0.671311,0.708041,0.673771,0.689560,0.710243,0.711907,0.652889,0.707977,0.632405,0.732053,0.753332,0.703140,0.650481,0.692320,0.786435,0.770809,0.741202,0.635416,0.660052,0.701792,0.751626,0.707773,0.713249,0.729928,0.684962,0.717682,0.723817,0.621374,0.738042,0.702452,0.655762,0.709688,0.695724,0.645184,0.673110,0.670072,0.695849,0.751060,0.709967,0.698671,0.681455,0.724017,0.747292,0.656592,0.747003,0.679411,0.764305,0.675941,0.731782,0.668520,0.711373,0.739586,0.751720,0.770446,0.656500,0.691803,0.653456,0.763604,0.702545,0.714652,0.677452,0.631198,0.745846,0.685309,0.695499,0.655445,0.681093,0.705697,0.673107,0.695927,0.663934,0.694160,0.718615,0.701518,0.757524,0.659936,0.675749,0.694658,0.682627,0.673432,0.699016,0.682174,0.700848,0.642644,0.737776,0.700607,0.704897,0.741374,0.692848,0.721040,0.692765,0.648781,0.672907,0.646425,0.593229,0.671717,0.674252,0.673471,0.745012,0.640639,0.628395,0.736605,0.685713,0.624730,0.683957,0.714516,0.667706,0.758114,0.764228,0.676013,0.629477,0.723794,0.630310,0.703695,0.721640,0.670041,0.692064,0.654272,0.708595,0.753313,0.713877,0.752365,0.746821,0.762121,0.734419,0.730979,0.726594,0.653048,0.737251,0.693449,0.729316,0.693223,0.740768,0.679787,0.651059,0.665461,0.726712,0.736941,0.701226,0.681649,0.640230,0.689950,0.803065,0.667456,0.727261,0.769618,0.672570,0.701632,0.736474,0.758429,0.702303,0.646929,0.676652,0.625989,0.699064,0.687388,0.636808,0.684785,0.733866,0.695588,0.645838,0.648065,0.606159,0.726147,0.577121,0.691373,0.678584,0.704975,0.683577,0.705682,0.748277,0.687129,0.718310,0.752528,0.752885,0.742462,0.785312,0.673001,0.586915,0.699661,0.716652,0.698407,0.721969,0.756345,0.737768,0.665183,0.694659,0.627371,0.659273,0.683507,0.691281,0.709147,0.720205,0.709433,0.742788,0.697307,0.642500,0.748510,0.686991,0.759991,0.699254,0.703453,0.705078,0.680338,0.669464,0.616259,0.677516,0.649483,0.713033,0.697428,0.759267,0.700454,0.707648,0.734599,0.784900,0.647024,0.692994,0.699015,0.692871,0.642504,0.625627,0.682233,0.677791,0.673654,0.666697,0.650468,0.701032,0.671835,0.700716,0.757912,0.664010,0.717160,0.665685,0.666313,0.679017,0.706096,0.694166,0.685082,0.721163,0.604452,0.658371,0.722096,0.648025,0.741632,0.703380,0.717261,0.659567,0.720078,0.682241,0.693333,0.654213,0.684108,0.686494,0.704477,0.680849,0.671324,0.639371,0.731368,0.664332,0.658664,0.673845,0.697170,0.681236,0.769822,0.709721,0.710385,0.744480,0.794241,0.688502,0.649355,0.737016,0.630351,0.723563,0.697026,0.757563,0.649860,0.674881,0.706545,0.697137,0.689335,0.602658,0.702426,0.762901,0.635889,0.655769,0.737412,0.641014,0.723889,0.688830,0.682507,0.682741,0.676228,0.687622,0.737491,0.677445,0.680115,0.673791,0.631181,0.723230,0.651630,0.629283,0.723497,0.711082,0.719282,0.675781,0.739076,0.679753,0.688597,0.620181,0.714687,0.735306,0.681414,0.638204,0.701053,0.590155,0.709755,0.668001,0.721879,0.752428,0.759174,0.661923,0.611478,0.723491,0.654446,0.681043,0.691205,0.720107,0.709210,0.737543,0.719479,0.690730,0.641698,0.662648,0.660303,0.662058,0.785732,0.684563,0.728032,0.734909,0.695748,0.721260,0.663229,0.702569,0.652391,0.734618,0.652475,0.665122,0.730497,0.694543,0.663098,0.708257,0.671941,0.716873,0.698975,0.648449,0.669501,0.643766,0.703377,0.669422,0.694725,0.656603,0.660563,0.703781,0.677299,0.686701,0.759449,0.706716,0.690568,0.680682,0.674028,0.781506,0.628010,0.683046,0.640589,0.689232,0.647786,0.695134,0.709819,0.717243,0.702276,0.677759,0.702841,0.562013,0.621577,0.683615,0.736914,0.690047,0.720301,0.689129,0.655025,0.732983,0.766876,0.657567,0.667799,0.763932,0.658562,0.677428,0.699775,0.726792,0.674865,0.680760,0.716215,0.720962,0.709916,0.701968,0.708887,0.673836,0.678353,0.707488,0.706341,0.716198,0.639978,0.708593,0.743186,0.611485,0.704122,0.771023,0.638650,0.606893,0.678685,0.737136,0.734713,0.673633,0.700009,0.684226,0.704176,0.655502,0.710146,0.681523,0.651448,0.663029,0.717774,0.668041,0.663392,0.633191,0.655384,0.610484,0.717640,0.673728,0.688029,0.646840,0.697661,0.702217,0.669591,0.697566,0.786366,0.681053,0.730030,0.631086,0.681234,0.720994,0.745270,0.737732,0.654352,0.667918,0.668127,0.698044,0.787011,0.675723,0.750890,0.741531,0.764130,0.741580,0.748197,0.641012,0.683865,0.712854,0.713929,0.681221,0.642793,0.729792,0.695487,0.669704,0.681127,0.736671,0.766100,0.698989,0.694811,0.704544,0.740208,0.713875,0.697676,0.697417,0.683409,0.629313,0.733216,0.629252,0.688099,0.685363,0.648376,0.703377,0.705389,0.711307,0.715728,0.651762,0.653272,0.744961,0.658279,0.757527,0.747980,0.762528,0.663688,0.755619,0.757378,0.667316,0.777242,0.715075,0.703094,0.757963,0.678500,0.713286,0.712787,0.665309,0.701962,0.697304,0.734251,0.657634,0.680296,0.691033,0.673949,0.695218,0.711404,0.704690,0.723361,0.711443,0.756612,0.720439,0.752935,0.609585,0.685397,0.748111,0.763867,0.734294,0.696764,0.697014,0.612983,0.636698,0.710316,0.696658,0.619180,0.680900,0.680497,0.695448,0.705354,0.757658,0.709245,0.714405,0.799255,0.668274,0.677785,0.675238,0.700440,0.705054,0.688988,0.737007,0.693527,0.614559,0.767676,0.729057,0.714369,0.729763,0.712772,0.658207,0.687335,0.648978,0.648738,0.707738,0.644094,0.677635,0.738722,0.664016,0.681183,0.681510,0.711412,0.724493,0.676853,0.698221,0.700562,0.744766,0.717011,0.574521,0.735276,0.680882,0.696333,0.733020,0.710737,0.695166,0.701436,0.721271,0.720395,0.735416,0.681768,0.667670,0.672609,0.672590,0.720685,0.654341,0.667202,0.698237,0.674813,0.668065,0.692556,0.725871,0.695125,0.703981,0.652236,0.709625,0.647792,0.746310,0.672653,0.707388,0.700548,0.718357,0.722180,0.735496,0.657785,0.739396,0.711762,0.669900,0.722381,0.642510,0.674789,0.741031,0.633948,0.811300,0.640137,0.706795,0.758810,0.819473,0.751508,0.780795,0.708333,0.666476,0.781082,0.695850,0.682359,0.678658,0.633721,0.747570,0.688039,0.701294,0.702277,0.673175,0.687728,0.690562,0.685503,0.682751,0.711606,0.622457,0.739317,0.711224,0.707646,0.787752,0.758416,0.695242,0.673258,0.676218,0.637287,0.676080,0.685146,0.694452,0.665975,0.684460,0.715799,0.706439,0.742146,0.723683,0.624027,0.684849,0.649958,0.690958,0.651939,0.702586,0.712157,0.666946,0.708933,0.692035,0.730458,0.685073,0.684496,0.674473,0.709931,0.678385,0.651995,0.597837,0.704431,0.715380,0.650468,0.730744,0.600743,0.728118,0.691078,0.708817,0.685346,0.721282,0.675970,0.636708,0.704850,0.716467,0.714601,0.707834,0.734998,0.701426,0.668410,0.727019,0.790783,0.767151,0.667567,0.732686,0.626359,0.639989,0.738951,0.701418,0.635359,0.736626,0.637238,0.643206,0.741052,0.709099,0.669584,0.666490,0.709823,0.630228,0.660665,0.699394,0.754172,0.677558,0.730668,0.693242,0.683857,0.699040,0.708559,0.726336,0.697197,0.676174,0.730493,0.737791,0.707012,0.778952,0.650597,0.638285,0.713032,0.730503,0.737834,0.565696,0.721984,0.727051,0.753049,0.720893,0.711041,0.707788,0.695239,0.691948,0.689901,0.713358,0.597745,0.722526,0.747510,0.673907,0.709344,0.643769,0.745296,0.682442,0.667250,0.705471,0.696852,0.701271,0.662267,0.723005,0.703611,0.693788,0.658486,0.683360,0.684537,0.787956,0.705756,0.636442,0.724532,0.684704,0.705534,0.702601,0.647281,0.638756,0.722717,0.646563,0.680536,0.666899,0.675218,0.705377,0.705610,0.716738,0.752337,0.662816,0.593696,0.624716,0.675195,0.698584,0.647043,0.721387,0.722875,0.699988,0.716885,0.636449,0.661361,0.703330,0.666414,0.601052,0.729480,0.671773,0.684114,0.664791,0.610105,0.666265,0.734850,0.669828,0.655046,0.706438,0.715725,0.611279,0.672183,0.738460,0.745851,0.635341,0.672933,0.719382,0.696624,0.695196,0.715731,0.679859,0.696813,0.717225,0.698615,0.629866,0.637064,0.666469,0.656379,0.753591,0.718475,0.733812,0.744912,0.753830,0.742103,0.736895,0.675782,0.703891,0.698866,0.674667,0.694223,0.594390,0.703315,0.747722,0.699316,0.626841,0.673577,0.664359,0.709131,0.718455,0.651863,0.712751,0.693912,0.721900,0.649725,0.617948,0.685235,0.655541,0.646877,0.686277,0.642298,0.741334,0.705922,0.711240,0.694418,0.697877,0.650758,0.760946,0.692616,0.669285,0.694259,0.717337,0.688392,0.704638,0.683255,0.655489,0.686667,0.632582,0.779644,0.736596,0.695400,0.705387,0.703084,0.720012,0.745193,0.638288,0.756286,0.663155,0.669103,0.681681,0.653830,0.682495,0.701308,0.691659,0.772819,0.755328,0.639609,0.704053,0.696543,0.677334,0.735973,0.698417,0.682945,0.650493,0.650530,0.754500,0.736578,0.721025,0.749462,0.729924,0.660368,0.727218,0.737934,0.769263,0.718593,0.555256,0.727481,0.695378,0.644652,0.670316,0.666457,0.628624,0.666767,0.648272,0.673604,0.710386,0.706236,0.677562,0.758346,0.705544,0.715019,0.688880,0.666440,0.677526,0.669976,0.710673,0.737322,0.750263,0.679430,]
    plt.plot(reward_hist) # plotting by columns
    plt.show()